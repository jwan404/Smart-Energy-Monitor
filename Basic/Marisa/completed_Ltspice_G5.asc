Version 4
SHEET 1 1700 1488
WIRE -4768 -1104 -4768 -1136
WIRE -4768 -1088 -4768 -1104
WIRE -2672 -1072 -2864 -1072
WIRE -2016 -1072 -2208 -1072
WIRE -4112 -1056 -4240 -1056
WIRE -4032 -1056 -4048 -1056
WIRE -3920 -1056 -3952 -1056
WIRE -3888 -1056 -3920 -1056
WIRE -3808 -1056 -3888 -1056
WIRE -3472 -1056 -3552 -1056
WIRE -3408 -1056 -3472 -1056
WIRE -3344 -1056 -3344 -1120
WIRE -3344 -1056 -3408 -1056
WIRE -3200 -1056 -3344 -1056
WIRE -2016 -1040 -2016 -1072
WIRE -2672 -1024 -2672 -1072
WIRE -3344 -944 -3344 -1056
WIRE -3200 -944 -3200 -1056
WIRE -2016 -928 -2016 -960
WIRE -3888 -896 -3888 -1056
WIRE -3472 -896 -3472 -1056
WIRE -2672 -864 -2672 -944
WIRE -2560 -864 -2672 -864
WIRE -3200 -848 -3200 -864
WIRE -3120 -848 -3200 -848
WIRE -3200 -832 -3200 -848
WIRE -2672 -816 -2672 -864
WIRE -2016 -800 -2016 -848
WIRE -1904 -800 -2016 -800
WIRE -1888 -800 -1904 -800
WIRE -2016 -784 -2016 -800
WIRE -4032 -736 -4288 -736
WIRE -3888 -736 -3888 -832
WIRE -3888 -736 -4032 -736
WIRE -3680 -736 -3680 -960
WIRE -3680 -736 -3888 -736
WIRE -3472 -736 -3472 -832
WIRE -3472 -736 -3680 -736
WIRE -3344 -736 -3344 -864
WIRE -3344 -736 -3472 -736
WIRE -3200 -736 -3200 -752
WIRE -3200 -736 -3344 -736
WIRE -4032 -704 -4032 -736
WIRE -4032 -688 -4032 -704
WIRE -2672 -608 -2672 -736
WIRE -2016 -592 -2016 -704
WIRE -2704 -208 -2720 -208
WIRE -2592 -208 -2624 -208
WIRE -1952 -208 -1968 -208
WIRE -1840 -208 -1872 -208
WIRE -1824 -160 -1904 -160
WIRE -2832 -144 -2912 -144
WIRE -2720 -144 -2720 -208
WIRE -2720 -144 -2752 -144
WIRE -2576 -144 -2656 -144
WIRE -2080 -144 -2144 -144
WIRE -1968 -144 -1968 -208
WIRE -1968 -144 -2000 -144
WIRE -1904 -144 -1904 -160
WIRE -2912 -128 -2912 -144
WIRE -2720 -128 -2720 -144
WIRE -2688 -128 -2720 -128
WIRE -2144 -128 -2144 -144
WIRE -1968 -128 -1968 -144
WIRE -1936 -128 -1968 -128
WIRE -1904 -128 -1904 -144
WIRE -2592 -112 -2592 -208
WIRE -2592 -112 -2624 -112
WIRE -2560 -112 -2592 -112
WIRE -1840 -112 -1840 -208
WIRE -1840 -112 -1872 -112
WIRE -1808 -112 -1840 -112
WIRE -2688 -96 -2720 -96
WIRE -1936 -96 -1968 -96
WIRE -2832 -80 -2864 -80
WIRE -2720 -80 -2720 -96
WIRE -2720 -80 -2752 -80
WIRE -2080 -80 -2112 -80
WIRE -1968 -80 -1968 -96
WIRE -1968 -80 -2000 -80
WIRE -2720 -64 -2720 -80
WIRE -2656 -64 -2656 -80
WIRE -1968 -64 -1968 -80
WIRE -1904 -64 -1904 -80
WIRE -1904 -48 -1904 -64
WIRE -2912 480 -3008 480
WIRE -2784 480 -2832 480
WIRE -2720 480 -2784 480
WIRE -2080 480 -2192 480
WIRE -1952 480 -2000 480
WIRE -1888 480 -1952 480
WIRE -2784 512 -2784 480
WIRE -1952 512 -1952 480
WIRE -2784 640 -2784 576
WIRE -1952 640 -1952 576
WIRE -2800 976 -2880 976
WIRE -1888 976 -1888 928
WIRE -1920 992 -2032 992
WIRE -2800 1008 -2800 976
WIRE -1664 1008 -1856 1008
WIRE -2832 1024 -2896 1024
WIRE -1920 1024 -2000 1024
WIRE -2624 1040 -2768 1040
WIRE -2832 1056 -2880 1056
WIRE -2000 1072 -2000 1024
WIRE -2880 1104 -2880 1056
WIRE -1888 1120 -1888 1040
WIRE -2800 1136 -2800 1072
FLAG -2208 -1072 Vac
FLAG -1904 -800 Vis
FLAG -2656 -144 5V
FLAG -2864 -80 Vvs
FLAG -2560 -112 Vvo
FLAG -3408 -1056 5VDis
FLAG -3920 -1056 Vin
FLAG -1888 480 Vfilter
FLAG -2720 480 Vfilter_vs
FLAG -4768 -1024 0
FLAG -4768 -1136 Vac
FLAG -3120 -848 Vshift
FLAG -3344 -1120 Vs5
FLAG -2864 -1072 Vac
FLAG -2672 -608 0
FLAG -2560 -864 Vvs
FLAG -2016 -592 0
FLAG -1968 16 Vshift
FLAG -1904 -64 0
FLAG -1824 -160 Vs5
FLAG -2144 -128 0
FLAG -2112 -80 Vis
FLAG -1808 -112 Vio
FLAG -2656 -64 0
FLAG -2912 -128 0
FLAG -2720 16 Vshift
FLAG -2576 -144 Vs5
FLAG -4240 -1056 Vac
FLAG -4032 -704 0
FLAG -2192 480 Vio
FLAG -3008 480 Vvo
FLAG -2784 640 0
FLAG -1952 640 0
FLAG -2880 1104 Vfilter_vs
FLAG -2000 1072 Vfilter_is
FLAG -2032 992 0
FLAG -2896 1024 0
FLAG -2800 1136 0
FLAG -1888 1120 0
FLAG -1888 928 Vs5
FLAG -2880 976 Vs5
FLAG -2624 1040 INT_vs
FLAG -1664 1008 INT_is
SYMBOL voltage -4768 -1120 R0
WINDOW 0 24 96 Left 2
WINDOW 3 22 124 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName Vsupply1
SYMATTR Value SINE(0 17.82 500)
SYMBOL res -2032 -944 R0
SYMATTR InstName Rload1
SYMATTR Value 25
SYMBOL ind -2032 -1056 R0
SYMATTR InstName Lload1
SYMATTR Value 4mH
SYMBOL res -2032 -800 R0
SYMATTR InstName Rs1
SYMATTR Value 0.5645
SYMBOL res -2688 -1040 R0
SYMATTR InstName Ra
SYMATTR Value 22k
SYMBOL res -2688 -832 R0
SYMATTR InstName Rb1
SYMATTR Value 1k
SYMBOL Opamps/opamp2 -1904 -176 R0
WINDOW 0 23 81 Left 2
WINDOW 3 24 105 Left 2
SYMATTR InstName U1
SYMATTR Value LM324
SYMBOL res -1984 -96 R90
WINDOW 0 62 55 VBottom 2
WINDOW 3 61 57 VTop 2
SYMATTR InstName R1d
SYMATTR Value 1.047k
SYMBOL res -1984 -160 R90
WINDOW 0 -58 59 VBottom 2
WINDOW 3 -32 55 VTop 2
SYMATTR InstName R1c
SYMATTR Value 1.047k
SYMBOL res -1856 -224 R90
WINDOW 0 -30 61 VBottom 2
WINDOW 3 -31 62 VTop 2
SYMATTR InstName R2a
SYMATTR Value 2.2k
SYMBOL res -1952 32 R180
WINDOW 0 -62 57 Left 2
WINDOW 3 -102 27 Left 2
SYMATTR InstName R2b
SYMATTR Value 2.2k
SYMBOL Opamps/opamp2 -2656 -176 R0
WINDOW 0 23 81 Left 2
WINDOW 3 24 105 Left 2
SYMATTR InstName U2
SYMATTR Value LM324
SYMBOL res -2736 -96 R90
WINDOW 0 62 55 VBottom 2
WINDOW 3 61 57 VTop 2
SYMATTR InstName R1b
SYMATTR Value 12.05k
SYMBOL res -2736 -160 R90
WINDOW 0 -32 53 VBottom 2
WINDOW 3 -32 55 VTop 2
SYMATTR InstName R1a
SYMATTR Value 13k
SYMBOL res -2608 -224 R90
WINDOW 0 -30 61 VBottom 2
WINDOW 3 -31 62 VTop 2
SYMATTR InstName R3a
SYMATTR Value 14.314k
SYMBOL res -2704 32 R180
WINDOW 0 -62 57 Left 2
WINDOW 3 -96 22 Left 2
SYMATTR InstName R3b
SYMATTR Value 14.314k
SYMBOL PowerProducts/LT1085-5 -3680 -1056 R0
SYMATTR InstName Reg1
SYMBOL res -3216 -960 R0
SYMATTR InstName R5
SYMATTR Value 2.7k
SYMBOL res -3936 -1072 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Rin1
SYMATTR Value 33
SYMBOL diode -4112 -1040 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D1
SYMATTR Value 1N4148
SYMBOL cap -3904 -896 R0
SYMATTR InstName Cin1
SYMATTR Value 47µ
SYMATTR SpiceLine Rser=0.001
SYMBOL cap -3488 -896 R0
SYMATTR InstName Cout1
SYMATTR Value 10µ
SYMATTR SpiceLine Rser=0.001
SYMBOL res -1984 464 R90
WINDOW 0 62 55 VBottom 2
WINDOW 3 61 57 VTop 2
SYMATTR InstName Rf2
SYMATTR Value 16k
SYMBOL cap -1936 576 R180
WINDOW 0 29 13 Left 2
WINDOW 3 33 -11 Left 2
SYMATTR InstName Cf1
SYMATTR Value 1nF
SYMBOL OpAmps\\opamp2 -1888 944 R0
SYMATTR InstName INT_is
SYMATTR Value LM324
SYMBOL res -2816 464 R90
WINDOW 0 62 55 VBottom 2
WINDOW 3 61 57 VTop 2
SYMATTR InstName Rf1
SYMATTR Value 16k
SYMBOL cap -2768 576 R180
WINDOW 0 29 13 Left 2
WINDOW 3 33 -11 Left 2
SYMATTR InstName Cf2
SYMATTR Value 1nF
SYMBOL res -3216 -848 R0
SYMATTR InstName R4
SYMATTR Value 2.2k
SYMBOL OpAmps\\opamp2 -2800 976 R0
SYMATTR InstName INT_vs
SYMATTR Value LM324
SYMBOL res -3360 -960 R0
SYMATTR InstName R1
SYMATTR Value 100
TEXT -2064 -1032 Right 2 ;Load \n(2.5VA-7.5VA)
TEXT -4080 -144 Left 2 ;.ac dec 30 1 1Meg
TEXT -4080 -208 Left 2 !.lib LM324.lib
TEXT -4088 -272 Left 2 ;Simulation Commands\n- Change these as needed
TEXT -4080 -176 Left 2 !.tran 0 20m 0 0.05m
TEXT -4080 -112 Left 2 !.ic V(Vin)=8
TEXT -4784 -1208 Left 4 ;power source
TEXT -3752 -1216 Left 4 ;regulator
TEXT -3000 -1224 Left 4 ;voltage sensor
TEXT -2200 -1216 Left 4 ;current sensor
TEXT -2264 -336 Left 4 ;signal conditioning - current sensor
TEXT -3128 -344 Left 4 ;signal conditioning - voltage sensor
TEXT -3040 -536 Left 2 ;- changed Ra and Rb values relative to the E12 series.
TEXT -2216 128 Left 2 ;- changed the resistor values using E12 values.
TEXT -2216 160 Left 2 ;- R1 values are a series combination of 1k Ohms and 47 Ohms resistors.
TEXT -2952 128 Left 2 ;- R (Thevnin) is 965.5 Ohms.
TEXT -2952 160 Left 2 ;- even if the Exact R values cannot be found
TEXT -2936 192 Left 2 ;in the E12 series, combinations can be made.
TEXT -3112 312 Left 4 ;Filtering Voltage sensor
TEXT -2232 320 Left 4 ;Filtering - Current sensor
TEXT -3184 816 Left 4 ;Zero crossing detector - voltage sensor
TEXT -2168 800 Left 4 ;Zero crossing detector - current sensor
TEXT -2992 1272 Left 2 ;- For the zero crossing circuit, we used an open loop comparator, where the V ref is 0 and the -Vcc is also zero.
TEXT -2992 1320 Left 2 ;- Since our signal is already filtered and processed, much noise will not be included.
TEXT -2992 1368 Left 2 ;- Hence we assumed it is safe to not use a buffer for the zero crossing detector circuit.
TEXT -2984 1424 Left 2 ;- For all values less than V ref (0V), Vout = 0
TEXT -2976 1472 Left 2 ;- every other value, the comparator will output 5V.
TEXT -3040 -488 Left 2 ;- Chose resistor values in the Kilo Ohm range to minimise error amplification and heat distribution.
RECTANGLE Normal -2724 -1100 -2588 -664 2
RECTANGLE Normal -2056 -1060 -1924 -832 2
RECTANGLE Normal -2056 -808 -1924 -696 2
RECTANGLE Normal -4120 -288 -3684 -84 2
